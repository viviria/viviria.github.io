require=function r(o,s,c){function l(t,e){if(!s[t]){if(!o[t]){var a="function"==typeof require&&require;if(!e&&a)return a(t,!0);if(u)return u(t,!0);var n=new Error("Cannot find module '"+t+"'");throw n.code="MODULE_NOT_FOUND",n}var i=s[t]={exports:{}};o[t][0].call(i.exports,function(e){return l(o[t][1][e]||e)},i,i.exports,r,o,s,c)}return s[t].exports}for(var u="function"==typeof require&&require,e=0;e<c.length;e++)l(c[e]);return l}({customerCardManager:[function(e,t,a){"use strict";cc._RF.push(t,"1ecffYDlxpBHZ9mJQcRGRGr","customerCardManager");var n=function(){function n(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,a){return t&&n(e.prototype,t),a&&n(e,a),e}}();var i=function(){function e(){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this._deck=null,this._customerCardData=null}return n(e,[{key:"_shuffle",value:function(e){for(var t=e.length-1;0<t;t--){var a=Math.floor(cc.random0To1()*(t+1)),n=e[t];e[t]=e[a],e[a]=n}}},{key:"load",value:function(e){this._customerCardData=e,this._deck=this._customerCardData.slice(0,this._customerCardData.length),this._shuffle(this._deck)}},{key:"drawCard",value:function(){return this._deck.pop()}},{key:"mixDeckCard",value:function(e){this._deck.push(e)}},{key:"shuffleDeck",value:function(){this._shuffle(this._deck)}}]),e}();t.exports={CustomerCardManager:i},cc._RF.pop()},{}],food:[function(e,t,a){"use strict";cc._RF.push(t,"313e9+z+RhF7JA29OKsy2wj","food");var n=function(){function n(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,a){return t&&n(e.prototype,t),a&&n(e,a),e}}();var i=cc.Enum({MEET:0,VEGETABLE:1,DRINK:2,FRUIT:3,SPECIAL:4}),r=cc.Enum({SEKIRYU:0}),o=function(){function a(e,t){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,a),this._foodType=e,this._specialFoodType=t}return n(a,[{key:"type",get:function(){return this._foodType}},{key:"specialFoodType",get:function(){return this._specialFoodType}}]),a}();t.exports={Food:o,FoodType:i,SpecialFoodType:r},cc._RF.pop()},{}],gameManager:[function(e,t,a){"use strict";cc._RF.push(t,"f2260RiVVRI7o2PpuT0JxD3","gameManager");var n=function(){function n(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,a){return t&&n(e.prototype,t),a&&n(e,a),e}}();var o=e("player").Player,i=function(){function r(e,t){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,r),this._players=[],this._turnPlayerIndex=0;for(var a=e>t.length?t.length:e,n=0;n<a;n++){var i=new o(t[n],"hiro"==t[n]);this._players.push(i)}}return n(r,[{key:"getPlayers",value:function(){return this._players}},{key:"init",value:function(){}},{key:"cleanUp",value:function(){this._turnPlayerIndex=(this._turnPlayerIndex+1)%this._players.length}},{key:"getTurnPlayer",value:function(){return this._players[this._turnPlayerIndex]}},{key:"showPlayer",value:function(){for(var e=0;e<this._players.length;e++)cc.log(this._players[e])}}]),r}();t.exports={GameManager:i},cc._RF.pop()},{player:"player"}],game:[function(e,t,a){"use strict";cc._RF.push(t,"012b1yJ2hZOMLkBge6DMWME","game");var n=e("./modules/gameManager").GameManager,i=e("./modules/mapTIleManager"),r=i.MapTileManager,h=i.IconType,o=i.IconNames,s=e("./modules/customerCardManager").CustomerCardManager,c=e("./modules/marketingCardManager").MarketingCardManager,l=cc.Enum({PLAYING:0,PLAYER_DETAIL_WINDOW:1}),u=cc.Enum({OTHER_PLAYER_WINDOW:0,CUSTOMER_WINDOW:1,ACTION_WINDOW:2}),p=["hiro","aya","shino","yomo"];cc.Class({extends:cc.Component,properties:{customersAtlas:{default:null,type:cc.SpriteAtlas},iconsAtlas:{default:null,type:cc.SpriteAtlas},_isLoadEnd:!1,_playerNum:0,_gameState:l.PLAYING,_LeftWindowState:u.OTHER_PLAYER_WINDOW,_gameManager:null,_mapTileManager:null,_customerCardManager:null,_marketingCardManager:null},onTapClosePlayerDetailWindow:function(){var e=this;this._gameState==l.PLAYER_DETAIL_WINDOW&&this.node.getChildByName("playerDetailWindow").getComponent("playerDetailWindow").close(function(){e._gameState=l.PLAYING})},onTapShowPlayerDetailWindow:function(){var e=this.node.getChildByName("playerDetailWindow");e.active||this._gameState!=l.PLAYING||(this._gameState=l.PLAYER_DETAIL_WINDOW,e.getComponent("playerDetailWindow").open())},onTapChangeLeftWindow:function(){var e=this.node.getChildByName("otherPlayersWindow"),t=this.node.getChildByName("customersWindow"),a=this.node.getChildByName("actionsWindow");switch(e.active=!1,t.active=!1,a.active=!1,this._LeftWindowState){case u.OTHER_PLAYER_WINDOW:t.active=!0,this._LeftWindowState=u.CUSTOMER_WINDOW;break;case u.CUSTOMER_WINDOW:a.active=!0,this._LeftWindowState=u.ACTION_WINDOW;break;case u.ACTION_WINDOW:e.active=!0,this._LeftWindowState=u.OTHER_PLAYER_WINDOW}},updatePlayerDetail:function(){for(var e=this._gameManager.getPlayers(),t=0;t<e.length;t++){var a=e[t],n=a.name,i=a.point,r=a.foodHands,o=a.specialHands,s=this.node.getChildByName("otherPlayersWindow").getChildByName(n);if(a.isOwn)this.node.getChildByName("pointLabel").getComponent(cc.Label).string=i+"pt";else if(s){s.getChildByName("pointLabel").getComponent(cc.Label).string=i+"pt",s.getChildByName("handNumLabel").getComponent(cc.Label).string="×"+r.length,s.getChildByName("marketingHandNumLabel").getComponent(cc.Label).string="×"+o.length}var c=this.node.getChildByName("otherPlayersPointWindow").getChildByName(n);if(!a.isOwn)c.getChildByName("pointLabel").getComponent(cc.Label).string=i+"pt"}},openCustomerSetting:function(){for(var e=this.node.getChildByName("customersWindow").getChildByName("customers").getChildren(),t=0;t<e.length;t++)if(t<this._playerNum+1){e[t].active=!0;var a=this._customerCardManager.drawCard();e[t].getComponent(cc.Sprite).spriteFrame=this.customersAtlas.getSpriteFrame(a.image);var n=e[t].getChildByName("pointLabel").getComponent(cc.Label);n.string=a.point+"pt",(0<a.specialCustomer.length||0<a.specialFood.length)&&(n.string+="+");var i=a.food;1<i.length&&(e[t].getChildByName("line").active=!0);for(var r=0;r<i.length;r++){for(var o=i[r],s=0,c=0;c<o.length;c++)o[c]==h.ALL&&s++;for(var l=0;l<o.length;l++)if(0<s){var u=e[t].getChildByName("all");u.active=!0,u.getChildByName("numLabel").getComponent(cc.Label).string="×"+s}else this.setCustomerFoodIcon(e[t],o[l],l,r)}}else e[t].active=!1},setCustomerFoodIcon:function(e,t,a,n){var i=o[t],r=new cc.Node;switch(t){case h.MEAT:r.scaleX=-.4,r.scaleY=.4;break;case h.SPECIAL:r.scale=.2;break;default:r.scale=.4}r.addComponent(cc.Sprite).spriteFrame=this.iconsAtlas.getSpriteFrame(i+"_icon"),e.getChildByName("foodIcons").addChild(r),r.x=50*a-25,r.y=-50*n+25},touchSetting:function(){this.node.on(cc.Node.EventType.TOUCH_START,function(e){e.getLocation()}),this.node.on(cc.Node.EventType.TOUCH_MOVE,function(e){e.getLocation()}),this.node.on(cc.Node.EventType.TOUCH_END,function(e){})},init:function(){cc.director.getCollisionManager().enabled=!0,this._isLoadEnd=!1,this._playerNum=4,this._gameManager=new n(this._playerNum,p),this._mapTileManager=new r,this._customerCardManager=new s,this._marketingCardManager=new c},onLoad:function(){var a=this;this.init(),cc.loader.load(cc.url.raw("resources/json/mapTile.json"),function(e,t){null===e&&(a._mapTileManager.load(t),cc.loader.load(cc.url.raw("resources/json/customer.json"),function(e,t){null===e&&(a._customerCardManager.load(t),cc.loader.load(cc.url.raw("resources/json/market.json"),function(e,t){null===e&&(a._marketingCardManager.load(t),a._isLoadEnd=!0)}))}))})},gameInit:function(){this._gameManager.showPlayer(),this._gameManager.init(),this.updatePlayerDetail();for(var e=[],t=0;t<p.length;t++){var a=this.node.getChildByName(p[t]);t<this._playerNum?e.push(a):a.active=!1}var n=this.node.getChildByName("map");n.getComponent("map").setMapTileManager(this._mapTileManager),n.getComponent("map").createEmptyMap(this._playerNum,e),this.openCustomerSetting(),this.touchSetting()},start:function(){},update:function(e){this._isLoadEnd&&(this.gameInit(),this._isLoadEnd=!1)}}),cc._RF.pop()},{"./modules/customerCardManager":"customerCardManager","./modules/gameManager":"gameManager","./modules/mapTIleManager":"mapTIleManager","./modules/marketingCardManager":"marketingCardManager"}],mapTIleManager:[function(e,t,a){"use strict";cc._RF.push(t,"2ac0bRH4v9MZqXzIofRKyEJ","mapTIleManager");var n=function(){function n(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,a){return t&&n(e.prototype,t),a&&n(e,a),e}}();var i=cc.Enum({MEAT:0,VEGETABLE:1,DRINK:2,FRUITS:3,SPECIAL:4,ALL:5,START:6,EMPTY:7,REVERSE:8}),r=function(){function e(){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this._deck=null,this._startMapTile=null,this._mapTileData=null}return n(e,[{key:"_shuffle",value:function(e){for(var t=e.length-1;0<t;t--){var a=Math.floor(cc.random0To1()*(t+1)),n=e[t];e[t]=e[a],e[a]=n}}},{key:"load",value:function(e){this._mapTileData=e,this._deck=this._mapTileData.filter(function(e){return e.type!==i.START}),this._startMapTile=this._mapTileData.filter(function(e){return e.type==i.START}),this._shuffle(this._deck),this._shuffle(this._startMapTile)}},{key:"mixDeckTile",value:function(e){this._deck.push(e),this._shuffle(this._deck)}},{key:"startTiles",get:function(){return this._startMapTile}},{key:"drawTile",get:function(){return this._deck.pop()}}]),e}();t.exports={IconType:i,IconNames:["meat","vegetable","drink","fruits","special","all","start","empty","reverse"],MapTileManager:r},cc._RF.pop()},{}],mapTile:[function(e,t,a){"use strict";cc._RF.push(t,"f6ed4klKn9Cr7dnlF6BKtr8","mapTile");var n=e("./mapTIleManager"),i=n.IconType,r=n.IconNames;cc.Class({extends:cc.Component,properties:{mapTileAtlas:{default:null,type:cc.SpriteAtlas},_type:i.EMPTY,_playerIcon:null},setMapTile:function(e,t){this._type=e,this.node.getChildByName("icon").getComponent(cc.Sprite).spriteFrame=this.mapTileAtlas.getSpriteFrame(r[this._type]);for(var a=this.node.getChildByName("edges").getChildren(),n=t.join,i=0;i<a.length;i++)a[i].getComponent(cc.Sprite).spriteFrame=this.mapTileAtlas.getSpriteFrame("edge"+n[i])},setPlayerIcon:function(e){this._playerIcon=e,this._playerIcon.removeFromParent(),this.node.addChild(this._playerIcon),this._playerIcon.position=cc.p(-30,30)},removePlayerIcon:function(){this.node.removeChild(this._playerIcon);var e=this._playerIcon;return this._playerIcon=null,e},start:function(){}}),cc._RF.pop()},{"./mapTIleManager":"mapTIleManager"}],map:[function(e,t,a){"use strict";cc._RF.push(t,"e9f70XOCvBOMZIiOlaRpHlp","map");var o=e("./modules/mapTIleManager").IconType;cc.Class({extends:cc.Component,properties:{mapTile:{default:null,type:cc.Prefab},_mapTileManager:null,_mapWidth:0,_mapHeight:0},setMapTileManager:function(e){this._mapTileManager=e},__setMapSize:function(e){switch(e){case 2:this._mapWidth=5,this._mapHeight=5;break;case 3:case 4:this._mapWidth=7,this._mapHeight=7}},__setStartMap:function(i,e){for(var r=this,t=this.node.getChildren().filter(function(e,t){var a=t%r._mapWidth,n=Math.floor(t/r._mapWidth);return i<3?e.active&&(0==n||n==r._mapHeight-1):e.active&&(0==n||n==r._mapHeight-1||0==a||a==r._mapWidth-1)}),a=this._mapTileManager.startTiles,n=0;n<t.length;n++)t[n].getComponent("mapTile").setMapTile(o.START,a[n]),t[n].getComponent("mapTile").setPlayerIcon(e[n])},createEmptyMap:function(e,t){this.__setMapSize(e);for(var a={start:-Math.floor(this._mapWidth/2),end:Math.floor(this._mapWidth/2)},n={start:-Math.floor(this._mapHeight/2),end:Math.floor(this._mapHeight/2)},i=0,r=1,o=a.start;o<=a.end;o++){for(var s=n.start;s<=n.end;s++){var c=cc.instantiate(this.mapTile),l=c.getContentSize();c.position=cc.p(s*l.width,o*l.height),c.active=-i<=s&&s<=i,this.node.addChild(c)}i+=r*=0==o?-1:1}this.__setStartMap(e,t)},onLoad:function(){},start:function(){}}),cc._RF.pop()},{"./modules/mapTIleManager":"mapTIleManager"}],marketingCardManager:[function(e,t,a){"use strict";cc._RF.push(t,"606acoZSgtH9JqCW3dYDSGq","marketingCardManager");var n=function(){function n(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,a){return t&&n(e.prototype,t),a&&n(e,a),e}}();var i=function(){function e(){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this._deck=null,this._marketingCardData=null}return n(e,[{key:"_shuffle",value:function(e){for(var t=e.length-1;0<t;t--){var a=Math.floor(cc.random0To1()*(t+1)),n=e[t];e[t]=e[a],e[a]=n}}},{key:"load",value:function(e){this._marketingCardData=e,this._deck=this._marketingCardData.slice(0,this._marketingCardData.length),this._shuffle(this._deck)}},{key:"drawCard",value:function(){return this._deck.pop()}},{key:"mixDeckCard",value:function(e){this._deck.push(e)}},{key:"shuffleDeck",value:function(){this._shuffle(this._deck)}}]),e}();t.exports={MarketingCardManager:i},cc._RF.pop()},{}],playerDetailWindow:[function(e,t,a){"use strict";cc._RF.push(t,"5c141LXF7REubw2/Ye9ydxu","playerDetailWindow");cc.Class({extends:cc.Component,properties:{},open:function(){this.node.active=!0,this.node.runAction(cc.scaleTo(.2,1))},close:function(e){var t=this;this.node.runAction(cc.sequence(cc.scaleTo(.2,0),cc.callFunc(function(){t.node.active=!1,e&&e()})))},start:function(){}}),cc._RF.pop()},{}],player:[function(e,t,a){"use strict";cc._RF.push(t,"21b15G8nMdDT5z/cM+pf7Ob","player");var n=function(){function n(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,a){return t&&n(e.prototype,t),a&&n(e,a),e}}();var i=function(){function a(e,t){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,a),this._name=e,this._isOwn=t,this._point=0,this._foodHands=[],this._specialHands=[],this._cutomers=[]}return n(a,[{key:"__addPoint",value:function(e){this._point+=e}},{key:"addCustomer",value:function(e){this._cutomers.push(e)}},{key:"addFoodHand",value:function(e){this._foodHands.push(e)}},{key:"addSpecialHand",value:function(e){this._specialHands.push(e)}},{key:"name",get:function(){return this._name}},{key:"isOwn",get:function(){return this._isOwn}},{key:"point",get:function(){return this._point}},{key:"customers",get:function(){return this._cutomers}},{key:"foodHands",get:function(){return this._foodHands}},{key:"specialHands",get:function(){return this._specialHands}}]),a}();t.exports={Player:i},cc._RF.pop()},{}]},{},["game","map","customerCardManager","food","gameManager","mapTIleManager","mapTile","marketingCardManager","player","playerDetailWindow"]);
//# sourceMappingURL=project.js.map